[require]
SPIRV YES
GL >= 4.5
GLSL >= 4.50
GL_ARB_gl_spirv

[vertex shader spirv]
; Automatically generated from the GLSL by gen_gl_spirv_tests.py. DO NOT EDIT
; SPIR-V
; Version: 1.0
; Generator: Khronos Glslang Reference Front End; 7
; Bound: 105
; Schema: 0
               OpCapability Shader
          %1 = OpExtInstImport "GLSL.std.450"
               OpMemoryModel Logical GLSL450
               OpEntryPoint Vertex %main "main" %_ %piglit_vertex %m1 %m2 %gl_VertexID %gl_InstanceID
               OpSource GLSL 450
               OpName %_ ""
               OpMemberDecorate %gl_PerVertex 0 BuiltIn Position
               OpMemberDecorate %gl_PerVertex 1 BuiltIn PointSize
               OpMemberDecorate %gl_PerVertex 2 BuiltIn ClipDistance
               OpMemberDecorate %gl_PerVertex 3 BuiltIn CullDistance
               OpDecorate %gl_PerVertex Block
               OpDecorate %piglit_vertex Location 0
               OpDecorate %m1 Location 0
               OpDecorate %m2 Location 4
               OpDecorate %gl_VertexID BuiltIn VertexId
               OpDecorate %gl_InstanceID BuiltIn InstanceId
       %void = OpTypeVoid
          %3 = OpTypeFunction %void
      %float = OpTypeFloat 32
    %v4float = OpTypeVector %float 4
       %uint = OpTypeInt 32 0
     %uint_1 = OpConstant %uint 1
%_arr_float_uint_1 = OpTypeArray %float %uint_1
%gl_PerVertex = OpTypeStruct %v4float %float %_arr_float_uint_1 %_arr_float_uint_1
%_ptr_Output_gl_PerVertex = OpTypePointer Output %gl_PerVertex
          %_ = OpVariable %_ptr_Output_gl_PerVertex Output
        %int = OpTypeInt 32 1
      %int_0 = OpConstant %int 0
%_ptr_Input_v4float = OpTypePointer Input %v4float
%piglit_vertex = OpVariable %_ptr_Input_v4float Input
%_ptr_Output_v4float = OpTypePointer Output %v4float
%_ptr_Function_v4float = OpTypePointer Function %v4float
%float_29616_166 = OpConstant %float 29616.166
%float_n21563_2676 = OpConstant %float -21563.2676
%float_n3274_39771 = OpConstant %float -3274.39771
%float_n7391_61914 = OpConstant %float -7391.61914
         %27 = OpConstantComposite %v4float %float_29616_166 %float_n21563_2676 %float_n3274_39771 %float_n7391_61914
%float_29371_457 = OpConstant %float 29371.457
%float_7793_47266 = OpConstant %float 7793.47266
%float_n20661_791 = OpConstant %float -20661.791
%float_n26402_4414 = OpConstant %float -26402.4414
         %33 = OpConstantComposite %v4float %float_29371_457 %float_7793_47266 %float_n20661_791 %float_n26402_4414
%float_11556_8564 = OpConstant %float 11556.8564
%float_20357_9199 = OpConstant %float 20357.9199
%float_15432_0186 = OpConstant %float 15432.0186
%float_17385_4688 = OpConstant %float 17385.4688
         %39 = OpConstantComposite %v4float %float_11556_8564 %float_20357_9199 %float_15432_0186 %float_17385_4688
%float_16690_9727 = OpConstant %float 16690.9727
%float_n30557_1582 = OpConstant %float -30557.1582
%float_n16199_5928 = OpConstant %float -16199.5928
%float_2088_69482 = OpConstant %float 2088.69482
         %45 = OpConstantComposite %v4float %float_16690_9727 %float_n30557_1582 %float_n16199_5928 %float_2088_69482
%mat4v4float = OpTypeMatrix %v4float 4
%_ptr_Output_mat4v4float = OpTypePointer Output %mat4v4float
         %m1 = OpVariable %_ptr_Output_mat4v4float Output
    %float_1 = OpConstant %float 1
    %float_0 = OpConstant %float 0
         %m2 = OpVariable %_ptr_Output_mat4v4float Output
%_ptr_Input_int = OpTypePointer Input %int
%gl_VertexID = OpVariable %_ptr_Input_int Input
%gl_InstanceID = OpVariable %_ptr_Input_int Input
       %main = OpFunction %void None %3
          %5 = OpLabel
         %v1 = OpVariable %_ptr_Function_v4float Function
         %v2 = OpVariable %_ptr_Function_v4float Function
         %v3 = OpVariable %_ptr_Function_v4float Function
         %v4 = OpVariable %_ptr_Function_v4float Function
         %18 = OpLoad %v4float %piglit_vertex
         %20 = OpAccessChain %_ptr_Output_v4float %_ %int_0
               OpStore %20 %18
               OpStore %v1 %27
               OpStore %v2 %33
               OpStore %v3 %39
               OpStore %v4 %45
         %49 = OpLoad %v4float %v1
         %50 = OpLoad %v4float %v2
         %51 = OpLoad %v4float %v3
         %52 = OpLoad %v4float %v4
         %55 = OpCompositeExtract %float %49 0
         %56 = OpCompositeExtract %float %49 1
         %57 = OpCompositeExtract %float %49 2
         %58 = OpCompositeExtract %float %49 3
         %59 = OpCompositeExtract %float %50 0
         %60 = OpCompositeExtract %float %50 1
         %61 = OpCompositeExtract %float %50 2
         %62 = OpCompositeExtract %float %50 3
         %63 = OpCompositeExtract %float %51 0
         %64 = OpCompositeExtract %float %51 1
         %65 = OpCompositeExtract %float %51 2
         %66 = OpCompositeExtract %float %51 3
         %67 = OpCompositeExtract %float %52 0
         %68 = OpCompositeExtract %float %52 1
         %69 = OpCompositeExtract %float %52 2
         %70 = OpCompositeExtract %float %52 3
         %71 = OpCompositeConstruct %v4float %55 %56 %57 %58
         %72 = OpCompositeConstruct %v4float %59 %60 %61 %62
         %73 = OpCompositeConstruct %v4float %63 %64 %65 %66
         %74 = OpCompositeConstruct %v4float %67 %68 %69 %70
         %75 = OpCompositeConstruct %mat4v4float %71 %72 %73 %74
               OpStore %m1 %75
         %77 = OpLoad %v4float %v4
         %78 = OpLoad %v4float %v3
         %79 = OpLoad %v4float %v2
         %80 = OpLoad %v4float %v1
         %81 = OpCompositeExtract %float %77 0
         %82 = OpCompositeExtract %float %77 1
         %83 = OpCompositeExtract %float %77 2
         %84 = OpCompositeExtract %float %77 3
         %85 = OpCompositeExtract %float %78 0
         %86 = OpCompositeExtract %float %78 1
         %87 = OpCompositeExtract %float %78 2
         %88 = OpCompositeExtract %float %78 3
         %89 = OpCompositeExtract %float %79 0
         %90 = OpCompositeExtract %float %79 1
         %91 = OpCompositeExtract %float %79 2
         %92 = OpCompositeExtract %float %79 3
         %93 = OpCompositeExtract %float %80 0
         %94 = OpCompositeExtract %float %80 1
         %95 = OpCompositeExtract %float %80 2
         %96 = OpCompositeExtract %float %80 3
         %97 = OpCompositeConstruct %v4float %81 %82 %83 %84
         %98 = OpCompositeConstruct %v4float %85 %86 %87 %88
         %99 = OpCompositeConstruct %v4float %89 %90 %91 %92
        %100 = OpCompositeConstruct %v4float %93 %94 %95 %96
        %101 = OpCompositeConstruct %mat4v4float %97 %98 %99 %100
               OpStore %m2 %101
               OpReturn
               OpFunctionEnd

[vertex shader]
#version 450 core

layout(location = 0) in vec4 piglit_vertex;
layout(location = 0) out mat4 m1;
layout(location = 4) out mat4 m2;

void main()
{
	gl_Position = piglit_vertex;

	vec4 v1 = vec4(29616.166598, -21563.2666972, -3274.39775692, -7391.61915007);
	vec4 v2 = vec4(29371.4563058, 7793.47278553, -20661.7912871, -26402.4415351);
	vec4 v3 = vec4(11556.8560616, 20357.9190661, 15432.018204, 17385.4694591);
	vec4 v4 = vec4(16690.9719539, -30557.1591211, -16199.592401, 2088.69494163);

	m1 = mat4(v1, v2, v3, v4);
	m2 = mat4(v4, v3, v2, v1);
}

[fragment shader spirv]
; Automatically generated from the GLSL by gen_gl_spirv_tests.py. DO NOT EDIT
; SPIR-V
; Version: 1.0
; Generator: Khronos Glslang Reference Front End; 7
; Bound: 104
; Schema: 0
               OpCapability Shader
          %1 = OpExtInstImport "GLSL.std.450"
               OpMemoryModel Logical GLSL450
               OpEntryPoint Fragment %main "main" %out_color %m1 %m2
               OpExecutionMode %main OriginLowerLeft
               OpSource GLSL 450
               OpDecorate %out_color Location 0
               OpDecorate %m1 Location 0
               OpDecorate %m2 Location 4
       %void = OpTypeVoid
          %3 = OpTypeFunction %void
      %float = OpTypeFloat 32
    %v4float = OpTypeVector %float 4
%_ptr_Output_v4float = OpTypePointer Output %v4float
  %out_color = OpVariable %_ptr_Output_v4float Output
    %float_0 = OpConstant %float 0
    %float_1 = OpConstant %float 1
         %12 = OpConstantComposite %v4float %float_0 %float_1 %float_0 %float_1
%_ptr_Function_v4float = OpTypePointer Function %v4float
         %15 = OpConstantComposite %v4float %float_1 %float_0 %float_0 %float_1
%mat4v4float = OpTypeMatrix %v4float 4
%_ptr_Input_mat4v4float = OpTypePointer Input %mat4v4float
         %m1 = OpVariable %_ptr_Input_mat4v4float Input
        %int = OpTypeInt 32 1
      %int_0 = OpConstant %int 0
%_ptr_Input_v4float = OpTypePointer Input %v4float
%float_29616_166 = OpConstant %float 29616.166
%float_n21563_2676 = OpConstant %float -21563.2676
%float_n3274_39771 = OpConstant %float -3274.39771
%float_n7391_61914 = OpConstant %float -7391.61914
         %28 = OpConstantComposite %v4float %float_29616_166 %float_n21563_2676 %float_n3274_39771 %float_n7391_61914
       %bool = OpTypeBool
     %v4bool = OpTypeVector %bool 4
      %int_1 = OpConstant %int 1
%float_29371_457 = OpConstant %float 29371.457
%float_7793_47266 = OpConstant %float 7793.47266
%float_n20661_791 = OpConstant %float -20661.791
%float_n26402_4414 = OpConstant %float -26402.4414
         %43 = OpConstantComposite %v4float %float_29371_457 %float_7793_47266 %float_n20661_791 %float_n26402_4414
      %int_2 = OpConstant %int 2
%float_11556_8564 = OpConstant %float 11556.8564
%float_20357_9199 = OpConstant %float 20357.9199
%float_15432_0186 = OpConstant %float 15432.0186
%float_17385_4688 = OpConstant %float 17385.4688
         %56 = OpConstantComposite %v4float %float_11556_8564 %float_20357_9199 %float_15432_0186 %float_17385_4688
      %int_3 = OpConstant %int 3
%float_16690_9727 = OpConstant %float 16690.9727
%float_n30557_1582 = OpConstant %float -30557.1582
%float_n16199_5928 = OpConstant %float -16199.5928
%float_2088_69482 = OpConstant %float 2088.69482
         %69 = OpConstantComposite %v4float %float_16690_9727 %float_n30557_1582 %float_n16199_5928 %float_2088_69482
         %m2 = OpVariable %_ptr_Input_mat4v4float Input
       %main = OpFunction %void None %3
          %5 = OpLabel
 %fail_color = OpVariable %_ptr_Function_v4float Function
               OpStore %out_color %12
               OpStore %fail_color %15
         %22 = OpAccessChain %_ptr_Input_v4float %m1 %int_0
         %23 = OpLoad %v4float %22
         %31 = OpFOrdNotEqual %v4bool %23 %28
         %32 = OpAny %bool %31
               OpSelectionMerge %34 None
               OpBranchConditional %32 %33 %34
         %33 = OpLabel
         %35 = OpLoad %v4float %fail_color
               OpStore %out_color %35
               OpBranch %34
         %34 = OpLabel
         %37 = OpAccessChain %_ptr_Input_v4float %m1 %int_1
         %38 = OpLoad %v4float %37
         %44 = OpFOrdNotEqual %v4bool %38 %43
         %45 = OpAny %bool %44
               OpSelectionMerge %47 None
               OpBranchConditional %45 %46 %47
         %46 = OpLabel
         %48 = OpLoad %v4float %fail_color
               OpStore %out_color %48
               OpBranch %47
         %47 = OpLabel
         %50 = OpAccessChain %_ptr_Input_v4float %m1 %int_2
         %51 = OpLoad %v4float %50
         %57 = OpFOrdNotEqual %v4bool %51 %56
         %58 = OpAny %bool %57
               OpSelectionMerge %60 None
               OpBranchConditional %58 %59 %60
         %59 = OpLabel
         %61 = OpLoad %v4float %fail_color
               OpStore %out_color %61
               OpBranch %60
         %60 = OpLabel
         %63 = OpAccessChain %_ptr_Input_v4float %m1 %int_3
         %64 = OpLoad %v4float %63
         %70 = OpFOrdNotEqual %v4bool %64 %69
         %71 = OpAny %bool %70
               OpSelectionMerge %73 None
               OpBranchConditional %71 %72 %73
         %72 = OpLabel
         %74 = OpLoad %v4float %fail_color
               OpStore %out_color %74
               OpBranch %73
         %73 = OpLabel
         %76 = OpAccessChain %_ptr_Input_v4float %m2 %int_3
         %77 = OpLoad %v4float %76
         %78 = OpFOrdNotEqual %v4bool %77 %28
         %79 = OpAny %bool %78
               OpSelectionMerge %81 None
               OpBranchConditional %79 %80 %81
         %80 = OpLabel
         %82 = OpLoad %v4float %fail_color
               OpStore %out_color %82
               OpBranch %81
         %81 = OpLabel
         %83 = OpAccessChain %_ptr_Input_v4float %m2 %int_2
         %84 = OpLoad %v4float %83
         %85 = OpFOrdNotEqual %v4bool %84 %43
         %86 = OpAny %bool %85
               OpSelectionMerge %88 None
               OpBranchConditional %86 %87 %88
         %87 = OpLabel
         %89 = OpLoad %v4float %fail_color
               OpStore %out_color %89
               OpBranch %88
         %88 = OpLabel
         %90 = OpAccessChain %_ptr_Input_v4float %m2 %int_1
         %91 = OpLoad %v4float %90
         %92 = OpFOrdNotEqual %v4bool %91 %56
         %93 = OpAny %bool %92
               OpSelectionMerge %95 None
               OpBranchConditional %93 %94 %95
         %94 = OpLabel
         %96 = OpLoad %v4float %fail_color
               OpStore %out_color %96
               OpBranch %95
         %95 = OpLabel
         %97 = OpAccessChain %_ptr_Input_v4float %m2 %int_0
         %98 = OpLoad %v4float %97
         %99 = OpFOrdNotEqual %v4bool %98 %69
        %100 = OpAny %bool %99
               OpSelectionMerge %102 None
               OpBranchConditional %100 %101 %102
        %101 = OpLabel
        %103 = OpLoad %v4float %fail_color
               OpStore %out_color %103
               OpBranch %102
        %102 = OpLabel
               OpReturn
               OpFunctionEnd

[fragment shader]
#version 450 core

layout(location = 0) in mat4 m1;
layout(location = 4) in mat4 m2;
layout(location = 0) out vec4 out_color;

void main()
{
	out_color = vec4(0.0, 1.0, 0.0, 1.0);
	vec4 fail_color = vec4(1.0, 0.0, 0.0, 1.0);

	if (m1[0] != vec4(29616.166598, -21563.2666972, -3274.39775692, -7391.61915007))
	   out_color = fail_color;

	if (m1[1] != vec4(29371.4563058, 7793.47278553, -20661.7912871, -26402.4415351))
	   out_color = fail_color;

	if (m1[2] != vec4(11556.8560616, 20357.9190661, 15432.018204, 17385.4694591))
	   out_color = fail_color;

	if (m1[3] != vec4(16690.9719539, -30557.1591211, -16199.592401, 2088.69494163))
	   out_color = fail_color;

	if (m2[3] != vec4(29616.166598, -21563.2666972, -3274.39775692, -7391.61915007))
	   out_color = fail_color;

	if (m2[2] != vec4(29371.4563058, 7793.47278553, -20661.7912871, -26402.4415351))
	   out_color = fail_color;

	if (m2[1] != vec4(11556.8560616, 20357.9190661, 15432.018204, 17385.4694591))
	   out_color = fail_color;

	if (m2[0] != vec4(16690.9719539, -30557.1591211, -16199.592401, 2088.69494163))
	   out_color = fail_color;

}

[test]
draw rect -1 -1 2 2
probe all rgba 0.0 1.0 0.0 1.0
